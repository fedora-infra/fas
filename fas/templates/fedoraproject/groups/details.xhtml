<%inherit file="/site.xhtml" />
<%namespace name="paging" file="/paging.xhtml"/>
  <div class="page-title">
    <img class="group" src="${request.static_url('fas:static/theme/fedoraproject/logo.png')}"/>
    <h1>${group.display_name}</h1>
    <p>${group.name}</p>
    %if group.parent_group_id > -1:
        <div>
          ${_(u'This group belong to')}
          <a href="${request.route_url('group-details', id=group.parent_group_id)}">
            ${parent_group.name}
          </a>
        </div>
    %endif
    %if request.authenticated_userid:
      %if request.authenticated_is_admin() \
            or request.authenticated_is_modo() \
            or request.authenticated_is_group_editor() \
            or request.authenticated_is_group_admin(group.name) :
          <button class="btn btn-default" type="button">
            <a href="${request.route_url('group-edit', id=group.id)}">
              ${_(u'Edit')}
            </a>
          </button>
      %endif
    %endif
  </div>
  %if group.description:
  <div>
    <p>${group.description}</p>
  </div>
  %endif
  <div class=row>
    <div class="col-sm-6 col-md-4">
      <h3></h3>
      <dl class="dl-horizontal">
           %if group.web_link:
             <dt>${_(u'Web page')}</dt>
             <dd>${group.web_link}</dd>
           %endif
           <dt>${_(u'Group type')}</dt>
           <dd>
           %if group.group_types:
             ${group.group_types.name}
           %endif
           </dd>
           <dt>${_(u'Principal Administrator')}</dt>
           <dd>
             <a href="${request.route_url('people-profile', id=group.owner_id)}
                data-toggle="tooltip" data-placement="top"
                title="${_(u'View profile')}">
               ${group.owner.username}
             </a>
           </dd>
      </dl>
    </div>
  </div>
  <div class=row>
    <div class="col-sm-6 col-md-4">
      <h3>${_(u'Contact information')}</h3>
      %if not group.mailing_list and not group.irc_channel:
        <div>
          <p>${_(u'No contact informations provided.')}</p>
        </div>
      %else:
        <dl class="dl-horizontal">
             <dt>${_(u'Mailing list')}</dt>
             <dd>
               <a href="mailto:${group.mailing_list}">${group.mailing_list}</a>
               %if group.mailing_list_url:
                 <a href="${group.mailing_list_url}">(${_(u'view list infos')})</a>
               %endif
             </dd>
             <dt>${_(u'IRC channel')}</dt>
             <dd>
               #${group.irc_channel}
               <a href="irc://${group.irc_network}">
                 (${group.irc_network})
               </a>
             </dd>
             <dt>${_(u'')}</dt>
             <dd></dd>
        </dl>
      %endif
    </div>
  </div>
  <div class=row>
    <div class="col-sm-6 col-md-4">
      <h3>${_(u'Membership')}</h3>
      %if not group.need_approval and group.license_sign_up == -1:
        <div>
          <p>${_(u'This group has no special requirements to apply to.')}</p>
          %if request.authenticated_userid and not is_member:
              <dd><button class="btn btn-default" type="button">${_(u'Join')}</button></dd>
          %endif
        </div>
        %if is_member:
          <dl class="dl-horizontal">
            <dt>${_(u'Your role')}</dt><dd>${person_membership.get_role().name.lower()}
            %if group.self_removal:
              <span><a href="#">(${_(u'revoke my membership')})</a></span>
            %else:
              <span><a href="#">(${_(u'request revoking')})</a></span>
            %endif
            </dd>
            %if request.authenticated_is_group_admin(group.name) \
                    or request.authenticated_is_group_sponsor(group.name):
              <dt>${_(u'Requests')}</dt>
              %if has_membership_request:
                <dd><a href="#">${_(u'View membership request')}</a></dd>
              %else:
                <dd><p>${_(u'None')}</p></dd>
              %endif
            %endif
          </dl>
        %endif
      %else:
        <dl class="dl-horizontal">
          %if group.apply_rules:
            <p>${group.apply_rules}</p>
          %endif
          %if group.need_approval:
            %if request.authenticated_userid and not is_member:
              %if person_membership is not None \
                and person_membership.get_status() == person_membership.get_status()['PENDING']:
                <dt>${_(u'Status')}</dt>
                  <dd><p> Pending...</p></dd>
                  %else:
                <form method="POST">
                <button class="btn btn-default" name="data" onClick="${group.id}">
                  ${_(u'Apply')}
                </button>
                <!--
                <button class="btn btn-default" name="data" onClick="add_membership">
                  ${_(u'Apply')}
                </button>
                -->
                </form>
                %endif
            %endif
          %endif
          %if group.license_sign_up > -1:
            <dt>${_(u'This group requires a license agreement')}</dt>
              %if license_signed_up:
                <dd>Signed up</dd> <!-- TODO: Add a nice glyphicon here -->
              %else:
                <dd><button class="btn btn-default" type="button">${_(u'Sign up')}</button></dd>
              %endif
          %endif
        </dl>
      %endif
    </div>
  </div>

  <div id=group-members-list>
    <h3>${_(u'Members')}</h3>
  </div>
  %if members > 0:
      <!--
      ${paging.list(name='people', route='group-details', param={'members_page': 2})}
      -->
      <!-- limit members list to 50 for now -->
      <div class="row">
      %for person, role in members[0:50]:
          <div class="col-sm-6 col-md-4 col-lg-4">
            <ul id="people">
              <li>
                <span>
                  <a href="${request.route_url('people-profile', id=person.id)}">
                    %if person.avatar:
                      <img class="profile" src="${person.avatar + '?s=100&d=monsterid'}" class="img-circle"/>
                    %else:
                      <img src="http://cdn.libravatar.org/avatar/" class="img-thumbnail"/>
                    %endif
                  </a>
                </span>
                <span>${person.fullname}</span>
                <span>(${_(role.name.lower())})</span>
              </li>
            </ul>
          </div>
      %endfor
      </div>
  %else:
    <div id="no-items-found">
      <p>${_(u'No members found.')}</p>
    </div>
  %endif
